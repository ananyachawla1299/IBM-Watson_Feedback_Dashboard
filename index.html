<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ED Chatbot Feedback Dashboard</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        .container { max-width: 1200px; margin: 0 auto; }
        .header {
            background: white;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
        }
        .header h1 { color: #2d3748; font-size: 2rem; margin-bottom: 10px; }
        .header p { color: #718096; margin-bottom: 20px; }
        
        .summary {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        .summary-item {
            background: #f7fafc;
            padding: 15px;
            border-radius: 8px;
            flex: 1;
            min-width: 200px;
        }
        .summary-label { color: #718096; font-size: 0.9rem; }
        .summary-value { color: #2d3748; font-size: 1.2rem; font-weight: bold; }
        
        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
        }
        .tab {
            padding: 12px 24px;
            background: #f7fafc;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            cursor: pointer;
            color: #4a5568;
            font-weight: 600;
        }
        .tab.active {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }
        
        .content {
            display: none;
        }
        .content.active {
            display: block;
        }
        
        .metrics {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        .metric {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        .metric-value {
            font-size: 2.5rem;
            font-weight: bold;
            color: #667eea;
            margin-bottom: 5px;
        }
        .metric-label {
            color: #718096;
            font-size: 0.9rem;
            font-weight: 600;
            text-transform: uppercase;
        }
        .metric-sublabel {
            color: #a0aec0;
            font-size: 0.8rem;
            margin-top: 5px;
        }
        
        .filters {
            background: white;
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 30px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }
        .filter-group {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }
        .filter-label {
            font-size: 0.85rem;
            color: #4a5568;
            font-weight: 600;
        }
        select {
            padding: 10px 15px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            background: white;
            cursor: pointer;
        }
        
        .card {
            background: white;
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            position: relative;
        }
        .card-title {
            font-size: 1.3rem;
            font-weight: 700;
            color: #2d3748;
            margin-bottom: 15px;
        }
        .chart-container {
            position: relative;
            height: 400px;
            width: 100%;
        }
        .chart-container.small {
            height: 250px;
        }
        .chart-container.trend {
            height: 200px;
        }
        
        /* Likert Scale Visualization */
        .likert-container {
            margin: 20px 0;
        }
        .likert-question {
            margin-bottom: 25px;
            padding: 15px;
            background: #f8fafc;
            border-radius: 8px;
        }
        .likert-question-text {
            font-weight: 600;
            color: #2d3748;
            margin-bottom: 10px;
        }
        .likert-scale {
            display: flex;
            height: 30px;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .likert-segment {
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            font-size: 0.85rem;
            transition: none;
        }
        .strongly-disagree { background-color: #dc2626; }
        .disagree { background-color: #f87171; }
        .neutral { background-color: #fbbf24; color: #000; }
        .agree { background-color: #84cc16; }
        .strongly-agree { background-color: #22c55e; }
        
        /* Word Cloud */
        .word-cloud {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
            justify-content: center;
            padding: 20px;
            background: #f8fafc;
            border-radius: 10px;
            margin: 20px 0;
        }
        .word-tag {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 0.9rem;
            cursor: pointer;
            transition: transform 0.2s;
        }
        .word-tag:hover {
            transform: scale(1.05);
        }
        .word-tag.large { font-size: 1.1rem; padding: 10px 20px; }
        .word-tag.medium { font-size: 1rem; padding: 9px 18px; }
        .word-tag.small { font-size: 0.85rem; padding: 6px 12px; }
        
        /* Semi-circle gauge */
        .gauge-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        .gauge-item {
            text-align: center;
            padding: 20px;
            background: #f8fafc;
            border-radius: 10px;
        }
        .gauge-title {
            font-weight: 600;
            color: #2d3748;
            margin-bottom: 10px;
            font-size: 0.9rem;
        }
        .gauge-value {
            font-size: 2rem;
            font-weight: bold;
            color: #667eea;
        }
        .gauge-subtitle {
            color: #718096;
            font-size: 0.8rem;
            margin-top: 5px;
        }
        
        .insights {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        .insight {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        .insight.value { border-left: 5px solid #22c55e; }
        .insight.pain { border-left: 5px solid #f59e0b; }
        .insight.opportunity { border-left: 5px solid #3b82f6; }
        .insight-title {
            font-weight: 700;
            color: #2d3748;
            margin-bottom: 15px;
        }
        .insight-list {
            list-style: none;
        }
        .insight-list li {
            padding: 8px 0;
            color: #4a5568;
            border-bottom: 1px solid #e2e8f0;
        }
        .insight-list li:last-child {
            border-bottom: none;
        }
        
        .refresh-btn {
            padding: 10px 20px;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            margin-left: auto;
        }
        .refresh-btn:hover {
            background: #5a67d8;
        }

        /* Legend for Likert scale */
        .likert-legend {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        .legend-item {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 0.85rem;
        }
        .legend-color {
            width: 15px;
            height: 15px;
            border-radius: 3px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ED Digital Front Door Feedback Dashboard</h1>
            <p>Real-time insights from IBM Watson Chatbot interactions</p>
            
            <div class="summary">
                <div class="summary-item">
                    <div class="summary-label">Total Respondents</div>
                    <div class="summary-value" id="total-count">3,000</div>
                </div>
                <div class="summary-item">
                    <div class="summary-label">Current View</div>
                    <div class="summary-value" id="current-view">All Patients</div>
                </div>
                <div class="summary-item">
                    <div class="summary-label">Filtered Count</div>
                    <div class="summary-value" id="filtered-count">3,000</div>
                </div>
            </div>
            
            <div class="tabs">
                <div class="tab active" onclick="showTab('patient')">Patient Feedback</div>
                <div class="tab" onclick="showTab('provider')">Provider Feedback</div>
                <div class="tab" onclick="showTab('demographics')">Demographics</div>
            </div>
        </div>

        <!-- Patient Content -->
        <div id="patient" class="content active">
            <div class="filters">
                <div class="filter-group">
                    <label class="filter-label">Age Group</label>
                    <select id="age-filter" onchange="updatePatientData()">
                        <option value="all">All Ages</option>
                        <option value="18-29">18-29</option>
                        <option value="30-44">30-44</option>
                        <option value="45-59">45-59</option>
                        <option value="60-74">60-74</option>
                        <option value="75+">75+</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label class="filter-label">Gender</label>
                    <select id="gender-filter" onchange="updatePatientData()">
                        <option value="all">All</option>
                        <option value="male">Male</option>
                        <option value="female">Female</option>
                        <option value="other">Other</option>
                    </select>
                </div>
                <button class="refresh-btn" onclick="refreshData()">Refresh</button>
            </div>

            <div class="metrics">
                <div class="metric">
                    <div class="metric-value" id="interactions">3,000</div>
                    <div class="metric-label">Total Interactions</div>
                    <div class="metric-sublabel">All respondents</div>
                </div>
                <div class="metric">
                    <div class="metric-value" id="completion">68%</div>
                    <div class="metric-label">Completion Rate</div>
                    <div class="metric-sublabel">2,040 completed</div>
                </div>
                <div class="metric">
                    <div class="metric-value" id="satisfaction">4.2</div>
                    <div class="metric-label">Avg Satisfaction</div>
                    <div class="metric-sublabel">Out of 5.0</div>
                </div>
                <div class="metric">
                    <div class="metric-value" id="nps">72</div>
                    <div class="metric-label">NPS Score</div>
                    <div class="metric-sublabel">1,530 promoters</div>
                </div>
            </div>

            <div class="card">
                <div class="card-title">Patient Experience Survey Results</div>
                <div class="likert-legend">
                    <div class="legend-item">
                        <div class="legend-color strongly-disagree"></div>
                        <span>Strongly Disagree</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color disagree"></div>
                        <span>Disagree</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color neutral"></div>
                        <span>Neutral</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color agree"></div>
                        <span>Agree</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color strongly-agree"></div>
                        <span>Strongly Agree</span>
                    </div>
                </div>
                <div class="likert-container" id="patient-likert">
                    <!-- Likert scales will be generated here -->
                </div>
            </div>

            <div class="card">
                <div class="card-title">Overall Satisfaction Metrics</div>
                <div class="gauge-grid" id="satisfaction-gauges">
                    <!-- Gauges will be generated here -->
                </div>
            </div>

            <div class="card">
                <div class="card-title">Patient Sentiment Analysis</div>
                <div class="word-cloud" id="patient-sentiment">
                    <!-- Word cloud will be generated here -->
                </div>
            </div>

            <div class="card">
                <div class="card-title">Recent Patient Comments</div>
                <div id="patient-comments">
                    <p style="color: #718096; font-style: italic;">Comments will load here...</p>
                </div>
            </div>
        </div>

        <!-- Provider Content -->
        <div id="provider" class="content">
            <div class="filters">
                <div class="filter-group">
                    <label class="filter-label">Role</label>
                    <select id="role-filter" onchange="updateProviderData()">
                        <option value="all">All Roles</option>
                        <option value="physician">Physicians</option>
                        <option value="nurse">Nurses</option>
                        <option value="admin">Administrators</option>
                    </select>
                </div>
                <button class="refresh-btn" onclick="refreshData()">Refresh</button>
            </div>

            <div class="insights">
                <div class="insight value">
                    <div class="insight-title">Top Value Drivers</div>
                    <ul class="insight-list">
                        <li>Pre-populated patient history saves 5 min/patient</li>
                        <li>Symptom summaries improve assessment by 30%</li>
                        <li>Risk stratification accuracy: 94%</li>
                        <li>Documentation time reduced by 40%</li>
                    </ul>
                </div>
                <div class="insight pain">
                    <div class="insight-title">Common Pain Points</div>
                    <ul class="insight-list">
                        <li>EMR integration delays (15% of cases)</li>
                        <li>Incomplete info for complex cases (22%)</li>
                        <li>Need pediatric-specific protocols</li>
                        <li>Peak hour connectivity issues</li>
                    </ul>
                </div>
                <div class="insight opportunity">
                    <div class="insight-title">Improvement Opportunities</div>
                    <ul class="insight-list">
                        <li>Add vital signs collection</li>
                        <li>Photo upload for injuries</li>
                        <li>Expand mental health screening</li>
                        <li>Real-time wait estimates</li>
                    </ul>
                </div>
            </div>

            <div class="metrics">
                <div class="metric">
                    <div class="metric-value">4.0</div>
                    <div class="metric-label">Provider Satisfaction</div>
                    <div class="metric-sublabel">85 providers surveyed</div>
                </div>
                <div class="metric">
                    <div class="metric-value">78%</div>
                    <div class="metric-label">Triage Alignment</div>
                    <div class="metric-sublabel">2,340 of 3,000 cases</div>
                </div>
                <div class="metric">
                    <div class="metric-value">85%</div>
                    <div class="metric-label">Efficiency Gain</div>
                    <div class="metric-sublabel">250 hours saved/month</div>
                </div>
                <div class="metric">
                    <div class="metric-value">92%</div>
                    <div class="metric-label">Response Rate</div>
                    <div class="metric-sublabel">78 of 85 responded</div>
                </div>
            </div>

            <div class="card">
                <div class="card-title">Provider System Evaluation</div>
                <div class="gauge-grid" id="provider-gauges">
                    <!-- Provider gauges will be generated here -->
                </div>
            </div>

            <div class="card">
                <div class="card-title">Provider Qualitative Feedback Themes</div>
                <div id="provider-themes">
                    <!-- Themes will be generated here -->
                </div>
            </div>
        </div>

        <!-- Demographics Content -->
        <div id="demographics" class="content">
            <div class="filters">
                <div class="filter-group">
                    <label class="filter-label">Primary Variable</label>
                    <select id="demo-primary" onchange="updateDemographics()">
                        <option value="age">Age Group</option>
                        <option value="gender">Gender</option>
                        <option value="tech">Tech Comfort</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label class="filter-label">Secondary Variable (Optional)</label>
                    <select id="demo-secondary" onchange="updateDemographics()">
                        <option value="none">None</option>
                        <option value="age">Age Group</option>
                        <option value="gender">Gender</option>
                        <option value="tech">Tech Comfort</option>
                    </select>
                </div>
            </div>

            <div class="metrics">
                <div class="metric">
                    <div class="metric-value">1,350</div>
                    <div class="metric-label">Male</div>
                    <div class="metric-sublabel">45% of total</div>
                </div>
                <div class="metric">
                    <div class="metric-value">1,560</div>
                    <div class="metric-label">Female</div>
                    <div class="metric-sublabel">52% of total</div>
                </div>
                <div class="metric">
                    <div class="metric-value">90</div>
                    <div class="metric-label">Other</div>
                    <div class="metric-sublabel">3% of total</div>
                </div>
                <div class="metric">
                    <div class="metric-value">46</div>
                    <div class="metric-label">Average Age</div>
                    <div class="metric-sublabel">Median: 44 years</div>
                </div>
            </div>

            <div class="card">
                <div class="card-title">Demographics Distribution</div>
                <div class="gauge-grid" id="demographics-display">
                    <!-- Demographics will be shown here -->
                </div>
            </div>
        </div>
    </div>

    <script>
        // Data object with Likert responses by demographic
        const data = {
            total: 3000,
            age: {
                'all': 3000,
                '18-29': 600,
                '30-44': 834,
                '45-59': 750,
                '60-74': 606,
                '75+': 210
            },
            gender: {
                'all': 3000,
                'male': 1350,
                'female': 1560,
                'other': 90
            },
            providers: {
                'all': 85,
                'physician': 35,
                'nurse': 40,
                'admin': 10
            },
            // Likert responses by demographic
            likertResponses: {
                'all': {
                    'easy_access': { sd: 5, d: 8, n: 15, a: 45, sa: 27 },
                    'clear_language': { sd: 3, d: 7, n: 12, a: 48, sa: 30 },
                    'clear_instructions': { sd: 4, d: 9, n: 18, a: 42, sa: 27 },
                    'accurate_understanding': { sd: 6, d: 11, n: 22, a: 38, sa: 23 },
                    'appropriate_recommendations': { sd: 5, d: 10, n: 20, a: 40, sa: 25 }
                },
                '18-29': {
                    'easy_access': { sd: 3, d: 5, n: 12, a: 50, sa: 30 },
                    'clear_language': { sd: 2, d: 4, n: 10, a: 52, sa: 32 },
                    'clear_instructions': { sd: 3, d: 6, n: 15, a: 48, sa: 28 },
                    'accurate_understanding': { sd: 4, d: 8, n: 18, a: 45, sa: 25 },
                    'appropriate_recommendations': { sd: 3, d: 7, n: 16, a: 46, sa: 28 }
                },
                '30-44': {
                    'easy_access': { sd: 4, d: 6, n: 14, a: 48, sa: 28 },
                    'clear_language': { sd: 2, d: 5, n: 11, a: 50, sa: 32 },
                    'clear_instructions': { sd: 3, d: 7, n: 16, a: 45, sa: 29 },
                    'accurate_understanding': { sd: 5, d: 9, n: 20, a: 42, sa: 24 },
                    'appropriate_recommendations': { sd: 4, d: 8, n: 18, a: 44, sa: 26 }
                },
                '45-59': {
                    'easy_access': { sd: 6, d: 10, n: 18, a: 42, sa: 24 },
                    'clear_language': { sd: 4, d: 8, n: 14, a: 46, sa: 28 },
                    'clear_instructions': { sd: 5, d: 10, n: 20, a: 40, sa: 25 },
                    'accurate_understanding': { sd: 7, d: 12, n: 24, a: 36, sa: 21 },
                    'appropriate_recommendations': { sd: 6, d: 11, n: 22, a: 38, sa: 23 }
                },
                '60-74': {
                    'easy_access': { sd: 8, d: 12, n: 20, a: 38, sa: 22 },
                    'clear_language': { sd: 6, d: 10, n: 18, a: 42, sa: 24 },
                    'clear_instructions': { sd: 7, d: 12, n: 22, a: 36, sa: 23 },
                    'accurate_understanding': { sd: 9, d: 14, n: 26, a: 32, sa: 19 },
                    'appropriate_recommendations': { sd: 8, d: 13, n: 24, a: 34, sa: 21 }
                },
                '75+': {
                    'easy_access': { sd: 12, d: 16, n: 24, a: 32, sa: 16 },
                    'clear_language': { sd: 10, d: 14, n: 22, a: 36, sa: 18 },
                    'clear_instructions': { sd: 11, d: 15, n: 24, a: 32, sa: 18 },
                    'accurate_understanding': { sd: 13, d: 17, n: 28, a: 28, sa: 14 },
                    'appropriate_recommendations': { sd: 12, d: 16, n: 26, a: 30, sa: 16 }
                },
                'male': {
                    'easy_access': { sd: 6, d: 9, n: 16, a: 43, sa: 26 },
                    'clear_language': { sd: 4, d: 7, n: 13, a: 46, sa: 30 },
                    'clear_instructions': { sd: 5, d: 9, n: 18, a: 41, sa: 27 },
                    'accurate_understanding': { sd: 7, d: 11, n: 22, a: 37, sa: 23 },
                    'appropriate_recommendations': { sd: 6, d: 10, n: 20, a: 39, sa: 25 }
                },
                'female': {
                    'easy_access': { sd: 4, d: 7, n: 14, a: 47, sa: 28 },
                    'clear_language': { sd: 2, d: 6, n: 11, a: 50, sa: 31 },
                    'clear_instructions': { sd: 3, d: 8, n: 17, a: 44, sa: 28 },
                    'accurate_understanding': { sd: 5, d: 10, n: 21, a: 40, sa: 24 },
                    'appropriate_recommendations': { sd: 4, d: 9, n: 19, a: 42, sa: 26 }
                },
                'other': {
                    'easy_access': { sd: 8, d: 12, n: 20, a: 38, sa: 22 },
                    'clear_language': { sd: 6, d: 10, n: 18, a: 42, sa: 24 },
                    'clear_instructions': { sd: 7, d: 12, n: 22, a: 36, sa: 23 },
                    'accurate_understanding': { sd: 9, d: 14, n: 26, a: 32, sa: 19 },
                    'appropriate_recommendations': { sd: 8, d: 13, n: 24, a: 34, sa: 21 }
                }
            }
        };

        // Tab switching function
        function showTab(tabName) {
            console.log('Switching to tab:', tabName);
            
            // Remove active class from all tabs and content
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.content').forEach(content => content.classList.remove('active'));
            
            // Add active class to clicked tab
            event.target.classList.add('active');
            
            // Show corresponding content
            document.getElementById(tabName).classList.add('active');
            
            // Update summary
            updateSummary(tabName);
            
            // Load data for the tab
            if (tabName === 'patient') {
                loadPatientComments();
            }
        }

        // Update summary based on active tab
        function updateSummary(tabName) {
            const totalEl = document.getElementById('total-count');
            const viewEl = document.getElementById('current-view');
            const countEl = document.getElementById('filtered-count');
            
            if (tabName === 'provider') {
                totalEl.textContent = '85';
                viewEl.textContent = 'All Providers';
                countEl.textContent = '85';
            } else {
                totalEl.textContent = '3,000';
                viewEl.textContent = 'All Patients';
                countEl.textContent = '3,000';
            }
        }

        // Update patient data based on filters
        function updatePatientData() {
            const ageFilter = document.getElementById('age-filter').value;
            const genderFilter = document.getElementById('gender-filter').value;
            
            let count = data.total;
            let filters = [];
            
            if (ageFilter !== 'all') {
                count = data.age[ageFilter];
                filters.push(ageFilter);
            }
            
            if (genderFilter !== 'all') {
                const ratio = data.gender[genderFilter] / data.total;
                count = Math.floor(count * ratio);
                filters.push(genderFilter);
            }
            
            // Update displays
            document.getElementById('interactions').textContent = count.toLocaleString();
            document.getElementById('filtered-count').textContent = count.toLocaleString();
            document.getElementById('current-view').textContent = filters.length > 0 ? filters.join(', ') : 'All Patients';
            
            const completion = Math.floor(count * 0.68);
            document.querySelector('#completion + .metric-sublabel').textContent = `${completion} completed`;
            
            // Update Likert scales based on filters
            updateLikertScales(ageFilter, genderFilter);
        }

        // Update provider data
        function updateProviderData() {
            const roleFilter = document.getElementById('role-filter').value;
            const count = data.providers[roleFilter];
            
            document.getElementById('filtered-count').textContent = count;
            document.getElementById('current-view').textContent = roleFilter === 'all' ? 'All Providers' : roleFilter;
        }

        // Update demographics
        function updateDemographics() {
            const primary = document.getElementById('demo-primary').value;
            const secondary = document.getElementById('demo-secondary').value;
            
            // Prevent selecting the same variable twice
            if (primary === secondary && secondary !== 'none') {
                document.getElementById('demo-secondary').value = 'none';
            }
            
            updateDemographicsDisplay();
        }

        // Load patient comments
        function loadPatientComments() {
            const comments = [
                {
                    text: "The chatbot was incredibly helpful in guiding me through my symptoms.",
                    date: "2025-08-19",
                    details: "Age: 30-44 • Female"
                },
                {
                    text: "Easy to use, but I wish it could handle more complex medical histories.",
                    date: "2025-08-18",
                    details: "Age: 45-59 • Male"
                },
                {
                    text: "The language was too technical for me to understand properly.",
                    date: "2025-08-17",
                    details: "Age: 75+ • Male"
                }
            ];
            
            const container = document.getElementById('patient-comments');
            if (container) {
                container.innerHTML = comments.map(comment => `
                    <div style="background: #f7fafc; padding: 15px; margin-bottom: 15px; border-radius: 8px; border-left: 4px solid #667eea;">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 8px; font-size: 0.85rem; color: #718096;">
                            <span>${comment.date} • ${comment.details}</span>
                        </div>
                        <div>${comment.text}</div>
                    </div>
                `).join('');
            }
        }

        // Refresh data
        function refreshData() {
            console.log('Refreshing data...');
            const satisfaction = (3.8 + Math.random() * 0.8).toFixed(1);
            document.getElementById('satisfaction').textContent = satisfaction;
            
            const nps = Math.floor(65 + Math.random() * 20);
            document.getElementById('nps').textContent = nps;
        }

        // Update Likert scales based on demographic filters
        function updateLikertScales(ageFilter, genderFilter) {
            let responses;
            
            // Determine which response set to use
            if (ageFilter !== 'all' && genderFilter === 'all') {
                // Use age-specific responses
                responses = data.likertResponses[ageFilter];
            } else if (genderFilter !== 'all' && ageFilter === 'all') {
                // Use gender-specific responses
                responses = data.likertResponses[genderFilter];
            } else if (ageFilter !== 'all' && genderFilter !== 'all') {
                // Use a combination (simplified - in a real app you'd have cross-tabulated data)
                // For demo purposes, we'll average the two
                const ageResponses = data.likertResponses[ageFilter];
                const genderResponses = data.likertResponses[genderFilter];
                
                responses = {};
                for (const key in ageResponses) {
                    responses[key] = {
                        sd: Math.round((ageResponses[key].sd + genderResponses[key].sd) / 2),
                        d: Math.round((ageResponses[key].d + genderResponses[key].d) / 2),
                        n: Math.round((ageResponses[key].n + genderResponses[key].n) / 2),
                        a: Math.round((ageResponses[key].a + genderResponses[key].a) / 2),
                        sa: Math.round((ageResponses[key].sa + genderResponses[key].sa) / 2)
                    };
                }
            } else {
                // Use overall responses
                responses = data.likertResponses['all'];
            }
            
            // Update the Likert scales
            createLikertScales(responses);
        }

        // Create Likert scale visualizations
        function createLikertScales(responses = data.likertResponses['all']) {
            const container = document.getElementById('patient-likert');
            if (!container) {
                console.log('Likert container not found');
                return;
            }
            
            const questions = [
                {
                    key: "easy_access",
                    text: "The chatbot was easy to access and start using"
                },
                {
                    key: "clear_language",
                    text: "The chatbot used clear, understandable language"
                },
                {
                    key: "clear_instructions",
                    text: "The chatbot provided clear instructions"
                },
                {
                    key: "accurate_understanding",
                    text: "The chatbot accurately understood my symptoms"
                },
                {
                    key: "appropriate_recommendations",
                    text: "The chatbot provided appropriate recommendations"
                }
            ];

            try {
                container.innerHTML = questions.map(q => {
                    const response = responses[q.key];
                    return `
                        <div class="likert-question">
                            <div class="likert-question-text">${q.text}</div>
                            <div class="likert-scale">
                                <div class="likert-segment strongly-disagree" style="width: ${response.sd}%">
                                    ${response.sd}%
                                </div>
                                <div class="likert-segment disagree" style="width: ${response.d}%">
                                    ${response.d}%
                                </div>
                                <div class="likert-segment neutral" style="width: ${response.n}%">
                                    ${response.n}%
                                </div>
                                <div class="likert-segment agree" style="width: ${response.a}%">
                                    ${response.a}%
                                </div>
                                <div class="likert-segment strongly-agree" style="width: ${response.sa}%">
                                    ${response.sa}%
                                </div>
                            </div>
                        </div>
                    `;
                }).join('');
                console.log('Likert scales created successfully');
            } catch (error) {
                console.error('Error creating Likert scales:', error);
            }
        }

        // Create satisfaction gauges
        function createSatisfactionGauges() {
            const container = document.getElementById('satisfaction-gauges');
            if (!container) return;
            
            const metrics = [
                { title: "Overall Satisfaction", value: "4.2", subtitle: "out of 5.0" },
                { title: "Net Promoter Score", value: "72", subtitle: "promoter score" },
                { title: "Completion Rate", value: "68%", subtitle: "finished survey" },
                { title: "Would Recommend", value: "84%", subtitle: "would recommend" }
            ];

            container.innerHTML = metrics.map(m => `
                <div class="gauge-item">
                    <div class="gauge-title">${m.title}</div>
                    <div class="gauge-value">${m.value}</div>
                    <div class="gauge-subtitle">${m.subtitle}</div>
                </div>
            `).join('');
        }

        // Create patient sentiment word cloud
        function createPatientSentiment() {
            const container = document.getElementById('patient-sentiment');
            if (!container) return;
            
            const words = [
                { text: "helpful", size: "large", freq: 245 },
                { text: "easy", size: "large", freq: 198 },
                { text: "clear", size: "medium", freq: 156 },
                { text: "quick", size: "medium", freq: 134 },
                { text: "accurate", size: "medium", freq: 122 },
                { text: "convenient", size: "small", freq: 98 },
                { text: "professional", size: "small", freq: 87 },
                { text: "responsive", size: "small", freq: 76 },
                { text: "intuitive", size: "small", freq: 65 },
                { text: "efficient", size: "small", freq: 54 }
            ];

            container.innerHTML = words.map(w => `
                <span class="word-tag ${w.size}" title="${w.freq} mentions">
                    ${w.text}
                </span>
            `).join('');
        }

        // Create provider gauges with half-donut charts
        function createProviderGauges() {
            const container = document.getElementById('provider-gauges');
            if (!container) return;
            
            const metrics = [
                { title: "Time Savings", value: 85, subtitle: "report time saved" },
                { title: "Data Accuracy", value: 79, subtitle: "accurate info" },
                { title: "System Integration", value: 65, subtitle: "good integration" },
                { title: "Workflow Efficiency", value: 88, subtitle: "improved workflow" },
                { title: "Clinical Relevance", value: 82, subtitle: "clinically useful" },
                { title: "User-Friendliness", value: 77, subtitle: "easy to use" }
            ];

            container.innerHTML = metrics.map((m, index) => `
                <div class="gauge-item">
                    <div class="gauge-title">${m.title}</div>
                    <div class="donut-container">
                        <canvas id="donut-${index}" class="donut-chart" width="120" height="120"></canvas>
                        <div class="donut-text">${m.value}%</div>
                    </div>
                    <div class="gauge-subtitle">${m.subtitle}</div>
                </div>
            `).join('');

            // Create the half-donut charts
            setTimeout(() => {
                metrics.forEach((metric, index) => {
                    createHalfDonut(`donut-${index}`, metric.value);
                });
            }, 100);
        }

        // Create individual half-donut chart
        function createHalfDonut(canvasId, percentage) {
            const canvas = document.getElementById(canvasId);
            if (!canvas || typeof Chart === 'undefined') return;

            new Chart(canvas, {
                type: 'doughnut',
                data: {
                    datasets: [{
                        data: [percentage, 100 - percentage],
                        backgroundColor: [
                            percentage >= 80 ? '#10b981' : percentage >= 60 ? '#fbbf24' : '#ef4444',
                            '#e5e7eb'
                        ],
                        borderWidth: 0
                    }]
                },
                options: {
                    rotation: -90,
                    circumference: 180,
                    responsive: false,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false },
                        tooltip: { enabled: false }
                    }
                }
            });
        }

        // Create provider themes
        function createProviderThemes() {
            const container = document.getElementById('provider-themes');
            if (!container) return;
            
            const themes = [
                {
                    category: "Positive Feedback",
                    color: "#22c55e",
                    items: [
                        "Saves significant time during initial assessment",
                        "Patient history is well-organized and comprehensive",
                        "Symptom summaries help focus clinical evaluation",
                        "Reduces repetitive questioning of patients"
                    ]
                },
                {
                    category: "Areas for Improvement",
                    color: "#f59e0b",
                    items: [
                        "EMR integration needs improvement",
                        "Complex cases sometimes lack detail",
                        "Need better pediatric-specific protocols",
                        "System can be slow during peak hours"
                    ]
                },
                {
                    category: "Feature Requests",
                    color: "#3b82f6",
                    items: [
                        "Add vital signs collection capability",
                        "Photo upload for visible injuries",
                        "Enhanced mental health screening",
                        "Real-time queue status updates"
                    ]
                }
            ];

            container.innerHTML = themes.map(theme => `
                <div style="margin-bottom: 25px; padding: 20px; background: #f8fafc; border-radius: 10px; border-left: 4px solid ${theme.color};">
                    <h4 style="color: #2d3748; margin-bottom: 15px; font-weight: 600;">${theme.category}</h4>
                    <ul style="list-style: none; margin: 0; padding: 0;">
                        ${theme.items.map(item => `
                            <li style="padding: 8px 0; color: #4a5568; border-bottom: 1px solid #e2e8f0;">
                                ${item}
                            </li>
                        `).join('')}
                    </ul>
                </div>
            `).join('');
        }

        // Update demographics display
        function updateDemographicsDisplay() {
            const container = document.getElementById('demographics-display');
            if (!container) return;
            
            const primary = document.getElementById('demo-primary').value;
            const secondary = document.getElementById('demo-secondary').value;
            
            let metrics = [];
            
            if (secondary === 'none') {
                // Single variable display
                if (primary === 'age') {
                    metrics = [
                        { title: "18-29 years", value: "600", subtitle: "20% of total" },
                        { title: "30-44 years", value: "834", subtitle: "28% of total" },
                        { title: "45-59 years", value: "750", subtitle: "25% of total" },
                        { title: "60-74 years", value: "606", subtitle: "20% of total" },
                        { title: "75+ years", value: "210", subtitle: "7% of total" }
                    ];
                } else if (primary === 'gender') {
                    metrics = [
                        { title: "Male", value: "1,350", subtitle: "45% of total" },
                        { title: "Female", value: "1,560", subtitle: "52% of total" },
                        { title: "Other/Non-binary", value: "90", subtitle: "3% of total" }
                    ];
                } else if (primary === 'tech') {
                    metrics = [
                        { title: "Very Comfortable", value: "1,050", subtitle: "35% of total" },
                        { title: "Comfortable", value: "900", subtitle: "30% of total" },
                        { title: "Neutral", value: "600", subtitle: "20% of total" },
                        { title: "Uncomfortable", value: "300", subtitle: "10% of total" },
                        { title: "Very Uncomfortable", value: "150", subtitle: "5% of total" }
                    ];
                }
            } else {
                // Dual variable cross-analysis
                if (primary === 'gender' && secondary === 'tech') {
                    metrics = [
                        { title: "Male - Very Comfortable", value: "473", subtitle: "35% of males" },
                        { title: "Male - Comfortable", value: "405", subtitle: "30% of males" },
                        { title: "Male - Neutral", value: "270", subtitle: "20% of males" },
                        { title: "Male - Uncomfortable", value: "135", subtitle: "10% of males" },
                        { title: "Male - Very Uncomfortable", value: "67", subtitle: "5% of males" },
                        { title: "Female - Very Comfortable", value: "546", subtitle: "35% of females" },
                        { title: "Female - Comfortable", value: "468", subtitle: "30% of females" },
                        { title: "Female - Neutral", value: "312", subtitle: "20% of females" },
                        { title: "Female - Uncomfortable", value: "156", subtitle: "10% of females" },
                        { title: "Female - Very Uncomfortable", value: "78", subtitle: "5% of females" }
                    ];
                } else if (primary === 'tech' && secondary === 'gender') {
                    metrics = [
                        { title: "Very Comfortable - Male", value: "473", subtitle: "45% of very comfortable" },
                        { title: "Very Comfortable - Female", value: "546", subtitle: "52% of very comfortable" },
                        { title: "Very Comfortable - Other", value: "31", subtitle: "3% of very comfortable" },
                        { title: "Comfortable - Male", value: "405", subtitle: "45% of comfortable" },
                        { title: "Comfortable - Female", value: "468", subtitle: "52% of comfortable" },
                        { title: "Comfortable - Other", value: "27", subtitle: "3% of comfortable" },
                        { title: "Neutral - Male", value: "270", subtitle: "45% of neutral" },
                        { title: "Neutral - Female", value: "312", subtitle: "52% of neutral" },
                        { title: "Neutral - Other", value: "18", subtitle: "3% of neutral" }
                    ];
                } else if (primary === 'age' && secondary === 'gender') {
                    metrics = [
                        { title: "18-29 - Male", value: "270", subtitle: "45% of 18-29" },
                        { title: "18-29 - Female", value: "312", subtitle: "52% of 18-29" },
                        { title: "18-29 - Other", value: "18", subtitle: "3% of 18-29" },
                        { title: "30-44 - Male", value: "375", subtitle: "45% of 30-44" },
                        { title: "30-44 - Female", value: "434", subtitle: "52% of 30-44" },
                        { title: "30-44 - Other", value: "25", subtitle: "3% of 30-44" },
                        { title: "45-59 - Male", value: "338", subtitle: "45% of 45-59" },
                        { title: "45-59 - Female", value: "390", subtitle: "52% of 45-59" },
                        { title: "45-59 - Other", value: "22", subtitle: "3% of 45-59" },
                        { title: "60-74 - Male", value: "273", subtitle: "45% of 60-74" },
                        { title: "60-74 - Female", value: "315", subtitle: "52% of 60-74" },
                        { title: "60-74 - Other", value: "18", subtitle: "3% of 60-74" },
                        { title: "75+ - Male", value: "94", subtitle: "45% of 75+" },
                        { title: "75+ - Female", value: "109", subtitle: "52% of 75+" },
                        { title: "75+ - Other", value: "7", subtitle: "3% of 75+" }
                    ];
                } else if (primary === 'gender' && secondary === 'age') {
                    metrics = [
                        { title: "Male - 18-29", value: "270", subtitle: "20% of males" },
                        { title: "Male - 30-44", value: "375", subtitle: "28% of males" },
                        { title: "Male - 45-59", value: "338", subtitle: "25% of males" },
                        { title: "Male - 60-74", value: "273", subtitle: "20% of males" },
                        { title: "Male - 75+", value: "94", subtitle: "7% of males" },
                        { title: "Female - 18-29", value: "312", subtitle: "20% of females" },
                        { title: "Female - 30-44", value: "434", subtitle: "28% of females" },
                        { title: "Female - 45-59", value: "390", subtitle: "25% of females" },
                        { title: "Female - 60-74", value: "315", subtitle: "20% of females" },
                        { title: "Female - 75+", value: "109", subtitle: "7% of females" }
                    ];
                } else if (primary === 'age' && secondary === 'tech') {
                    metrics = [
                        { title: "18-29 - Very Comfortable", value: "210", subtitle: "35% of 18-29" },
                        { title: "18-29 - Comfortable", value: "180", subtitle: "30% of 18-29" },
                        { title: "18-29 - Neutral", value: "120", subtitle: "20% of 18-29" },
                        { title: "18-29 - Uncomfortable", value: "60", subtitle: "10% of 18-29" },
                        { title: "18-29 - Very Uncomfortable", value: "30", subtitle: "5% of 18-29" },
                        { title: "30-44 - Very Comfortable", value: "292", subtitle: "35% of 30-44" },
                        { title: "30-44 - Comfortable", value: "250", subtitle: "30% of 30-44" },
                        { title: "30-44 - Neutral", value: "167", subtitle: "20% of 30-44" },
                        { title: "30-44 - Uncomfortable", value: "83", subtitle: "10% of 30-44" },
                        { title: "30-44 - Very Uncomfortable", value: "42", subtitle: "5% of 30-44" },
                        { title: "45-59 - Very Comfortable", value: "263", subtitle: "35% of 45-59" },
                        { title: "45-59 - Comfortable", value: "225", subtitle: "30% of 45-59" },
                        { title: "45-59 - Neutral", value: "150", subtitle: "20% of 45-59" },
                        { title: "45-59 - Uncomfortable", value: "75", subtitle: "10% of 45-59" },
                        { title: "45-59 - Very Uncomfortable", value: "37", subtitle: "5% of 45-59" }
                    ];
                } else if (primary === 'tech' && secondary === 'age') {
                    metrics = [
                        { title: "Very Comfortable - 18-29", value: "210", subtitle: "20% of very comfortable" },
                        { title: "Very Comfortable - 30-44", value: "294", subtitle: "28% of very comfortable" },
                        { title: "Very Comfortable - 45-59", value: "263", subtitle: "25% of very comfortable" },
                        { title: "Very Comfortable - 60-74", value: "210", subtitle: "20% of very comfortable" },
                        { title: "Very Comfortable - 75+", value: "73", subtitle: "7% of very comfortable" },
                        { title: "Comfortable - 18-29", value: "180", subtitle: "20% of comfortable" },
                        { title: "Comfortable - 30-44", value: "252", subtitle: "28% of comfortable" },
                        { title: "Comfortable - 45-59", value: "225", subtitle: "25% of comfortable" },
                        { title: "Comfortable - 60-74", value: "180", subtitle: "20% of comfortable" },
                        { title: "Comfortable - 75+", value: "63", subtitle: "7% of comfortable" },
                        { title: "Neutral - 18-29", value: "120", subtitle: "20% of neutral" },
                        { title: "Neutral - 30-44", value: "168", subtitle: "28% of neutral" },
                        { title: "Neutral - 45-59", value: "150", subtitle: "25% of neutral" },
                        { title: "Neutral - 60-74", value: "120", subtitle: "20% of neutral" },
                        { title: "Neutral - 75+", value: "42", subtitle: "7% of neutral" }
                    ];
                }
            }

            container.innerHTML = metrics.map(m => `
                <div class="gauge-item">
                    <div class="gauge-title">${m.title}</div>
                    <div class="gauge-value">${m.value}</div>
                    <div class="gauge-subtitle">${m.subtitle}</div>
                </div>
            `).join('');
        }

        // Initialize on page load
        window.addEventListener('load', function() {
            console.log('Page loaded, initializing...');
            loadPatientComments();
            createLikertScales();
            createSatisfactionGauges();
            createPatientSentiment();
            createProviderGauges();
            createProviderThemes();
            updateDemographicsDisplay();
        });
    </script>
</body>
</html>